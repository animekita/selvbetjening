{% extends "sadmin/base/extendedsite.html" %}
{% load i18n i18n %}

{% block content_title %}<h2>{% trans "Financial Report" %}</h2>{% endblock %}

{% block content %}

<form method="POST" action="">{% csrf_token %}

{% for fieldset in adminformattingform %}
      {% include "admin/includes/fieldset.html" %}
{% endfor %}

    <div class="submit-row" >
    <input type="submit" value="Update report" class="default" name="do_show" />
    </div>
</form>

<h3>Oversigt</h3>
<fieldset class="module aligned ">
<table style="width: 100%;">

<tr class="form-row type">
    <th>Linje navn</th>
    <th>Overbetalt</th>
    <th>Betalt</th>
    <th>Delvist betalt</th>
    <th>Ikke betalt</th>
    <th>Total</th>
</tr>

{% for line_group in line_groups %}

<tr class="form-row type line_group">
    <td>{{line_group.name}}</td>
    <td>{{line_group.overpaid|length}} ({{line_group.overpaid_total}},-)</td>
    <td>{{line_group.paid|length}} ({{line_group.paid_total}},-)</td>
    <td>{{line_group.partial|length}} ({{line_group.partial_total}},-)</td>
    <td>{{line_group.unpaid|length}} ({{line_group.unpaid_total}},-)</td>
    <td>{{line_group.lines|length}} ({{line_group.total}},-)</td>
</tr>

{% endfor %}

<tr class="form-row type line_group">
    <td><b>Total</b></td>
    <td><b>({{total.overpaid}},-)</b></td>
    <td><b>({{total.paid}},-)</b></td>
    <td><b>({{total.partial}},-)</b></td>
    <td><b>({{total.unpaid}},-)</b></td>
    <td><b>({{total.total}},-)</b></td>
</tr>

</table>
</fieldset>

<h3>Detaljeret opg√∏relse</h3>
<fieldset class="module aligned ">
<table style="width: 100%;">

<tr class="form-row type">
    <th>Linje navn</th>
    <th>Overbetalt</th>
    <th>Betalt</th>
    <th>Delvist betalt</th>
    <th>Ikke betalt</th>
    <th>Total</th>
</tr>

{% for line_group in line_groups %}

<tr class="form-row type line_group">
    <td><h4>{{line_group.name}}</h4></td>
    <td>{{line_group.overpaid|length}} ({{line_group.overpaid_total}},-)</td>
    <td>{{line_group.paid|length}} ({{line_group.paid_total}},-)</td>
    <td>{{line_group.partial|length}} ({{line_group.partial_total}},-)</td>
    <td>{{line_group.unpaid|length}} ({{line_group.unpaid_total}},-)</td>
    <td>{{line_group.lines|length}} ({{line_group.total}},-)</td>
</tr>

{% for line in line_group.lines %}
<tr>
    <td><p>{{line.revision.invoice.user}}</p></td>

    <td>{% if line.revision.invoice.is_overpaid %}x{% endif %}</td>
    <td>{% if line.revision.invoice.in_balance %}x{% endif %}</td>
    <td>{% if line.revision.invoice.is_partial %}x{% endif %}</td>
    <td>{% if line.revision.invoice.is_unpaid %}x{% endif %}</td>

    <td>{{line.price}},-</td>
</tr>
{% endfor %}


{% endfor %}


</table>
</fieldset>
{% endblock %}