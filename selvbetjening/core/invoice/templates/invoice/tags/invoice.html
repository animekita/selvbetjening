<table class="invoice">
{% for line in invoice.line_set.all %}
    {% ifchanged line.group_name %}
    <tr class="invoice_group"><th colspan="2">{{line.group_name}}</th></tr>
    {% endifchanged %}

    <tr class="invoice_item"><td>{{line.description}}</td><td>{% ifnotequal line.price 0 %}{{line.price}},-{% endifnotequal %}</td></tr>
{% endfor %}
</table>